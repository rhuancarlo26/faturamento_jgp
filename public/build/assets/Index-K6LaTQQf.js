import{r as y,b as _,c as i,o as n,a as t,k as m,t as l,j as r,y as b,C as k,w as p,B as g,u as c,F as A,E as O}from"./app-BH_YfDU3.js";import{d as C}from"./index-Ds4mjRDd.js";const X={class:"min-vh-100 bg-light"},D={class:"navbar navbar-dark",style:{"background-color":"#3d85c6"}},L={class:"container-fluid d-flex align-items-center"},R={class:"dropdown ml-auto"},U={class:"navbar-text text-white dropdown-toggle d-flex align-items-center",id:"userDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},B={class:"dropdown-menu dropdown-menu-right","aria-labelledby":"userDropdown"},P={class:"d-flex"},T={class:"flex-grow-1 p-4"},E={class:"container-fluid bg-white rounded-lg shadow p-4",style:{"max-width":"1690px"}},I={key:0,class:"alert alert-success alert-dismissible fade show",role:"alert"},V={class:"form-group col-md-4"},F={class:"form-group col-md-4"},j={class:"form-group col-md-4 d-flex align-items-end"},N=["disabled"],z={class:"table-responsive"},M={class:"table table-bordered table-hover"},q={class:"thead-light"},Q={key:0,class:"text-center align-middle"},$={class:"text-center align-middle"},G={class:"text-center align-middle"},J={class:"text-center align-middle"},H={class:"text-center align-middle"},K={class:"text-center align-middle"},W={class:"text-center align-middle"},Y={class:"text-center align-middle"},Z={class:"text-center align-middle"},tt={class:"text-center align-middle"},et={key:0,class:"text-center align-middle"},st={class:"d-flex justify-content-center align-items-center"},ot=["onClick"],lt=["href"],dt={key:0},at=["colspan"],ct={__name:"Index",props:{subprodutos:Array,dataInicial:String,dataFinal:String,user:Object},setup(a){const f=a,o=C.useForm({data_inicial:"",data_final:""}),u=y(null),x=()=>{o.get("/subprodutos",{preserveState:!0})},h=()=>{o.reset(),o.get("/subprodutos")},v=d=>{confirm("Tem certeza que deseja excluir este subproduto?")&&o.delete(`/subprodutos/${d}`,{onSuccess:e=>{u.value=e.props.flash?.success||"Subproduto excluído!"},onFinish:()=>{o.reset()}})},S=()=>{o.post("/logout",{onSuccess:()=>{window.location.href="/subprodutos"}})},w=()=>{if(typeof XLSX>"u"){console.error("XLSX library not loaded");return}const d=XLSX.utils.json_to_sheet(f.subprodutos.map(s=>({Rodovia:s.rodovia,"Prod. Subproduto":s.id_subproduto,"Cod.SIAC":s.cod_siac,"Descrição do Serviço":s.subproduto,Quantidade:s.quantidade,Unidade:s.unidade,"Qtd. Medida":s.quantidade_medida,"SEI Versão Aprovada":s.sei_versao_aprovada,"Parecer Técnico/Portaria/Ofício Aprovação - SEI":s.oficio_numero}))),e=XLSX.utils.book_new();XLSX.utils.book_append_sheet(e,d,"Subprodutos"),XLSX.writeFile(e,"subprodutos.xlsx")};return _(()=>{if(!window.XLSX){const d=document.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",d.async=!0,d.onload=()=>console.log("XLSX loaded successfully"),d.onerror=()=>console.error("Failed to load XLSX library"),document.head.appendChild(d)}}),(d,e)=>(n(),i("div",X,[t("nav",D,[t("div",L,[e[4]||(e[4]=t("img",{src:"/images/logo.jpg",alt:"Logo",style:{height:"40px","margin-right":"10px"}},null,-1)),e[5]||(e[5]=t("span",{class:"navbar-brand mb-0 h1"},"Sistema de Controle JGP - DNIT",-1)),t("div",R,[t("span",U,[e[3]||(e[3]=t("i",{class:"fas fa-user-circle mr-2",style:{"font-size":"1.5rem"}},null,-1)),m(" "+l(a.user?.name||"Visitante"),1)]),t("div",B,[a.user?(n(),i("a",{key:0,class:"dropdown-item",href:"#",onClick:b(S,["prevent"])},"Sair")):r("",!0)])])])]),t("div",P,[e[21]||(e[21]=k('<div class="bg-white border-right shadow-sm" style="width:250px;min-height:calc(100vh - 56px);"><ul class="nav flex-column p-3"><li class="nav-item"><a class="nav-link text-uppercase font-weight-bold" style="color:#4B5563;font-size:0.9rem;" href="/subprodutos"><i class="fas fa-search mr-2" style="color:#007BFF;"></i> CONSULTAR SUBPRODUTOS </a></li><li class="nav-item"><a class="nav-link text-uppercase font-weight-bold" style="color:#4B5563;font-size:0.9rem;" href="/subprodutos/create"><i class="fas fa-plus-circle mr-2" style="color:#28A745;"></i> CADASTRAR SUBPRODUTOS </a></li></ul></div>',1)),t("div",T,[t("div",E,[e[19]||(e[19]=t("h3",{class:"text-center mb-4 font-weight-bold",style:{color:"#4B5563","font-size":"1.3rem"}},"CONSULTAR SUBPRODUTOS APROVADOS",-1)),u.value?(n(),i("div",I,[m(l(u.value)+" ",1),t("button",{type:"button",class:"close",onClick:e[0]||(e[0]=s=>u.value=null),"aria-label":"Close"},[...e[6]||(e[6]=[t("span",{"aria-hidden":"true"},"×",-1)])])])):r("",!0),t("form",{onSubmit:b(x,["prevent"]),class:"form-row mb-5 p-4 bg-white rounded-lg shadow-sm border border-gray-200"},[t("div",V,[e[7]||(e[7]=t("label",{class:"form-label font-weight-semibold"},"Data Inicial",-1)),p(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>c(o).data_inicial=s),class:"form-control"},null,512),[[g,c(o).data_inicial]])]),t("div",F,[e[8]||(e[8]=t("label",{class:"form-label font-weight-semibold"},"Data Final",-1)),p(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>c(o).data_final=s),class:"form-control"},null,512),[[g,c(o).data_final]])]),t("div",j,[t("button",{type:"submit",class:"btn btn-primary mr-2",disabled:c(o).processing},"CONSULTAR",8,N),t("button",{type:"type",class:"btn btn-outline-secondary",onClick:h},"LIMPAR")])],32),e[20]||(e[20]=t("h3",{class:"text-center mb-3 font-weight-bold",style:{color:"#4B5563","font-size":"1.25rem"}},"RELAÇÃO DOS SUBPRODUTOS APROVADOS",-1)),t("div",{class:"mb-3 text-right"},[t("button",{onClick:w,class:"btn btn-success"},[...e[9]||(e[9]=[t("i",{class:"fas fa-file-excel mr-2"},null,-1),m(" Baixar ",-1)])])]),t("div",z,[t("table",M,[t("thead",q,[t("tr",null,[e[10]||(e[10]=t("th",{class:"text-center align-middle"},"Rodovia",-1)),e[11]||(e[11]=t("th",{class:"text-center align-middle"},"Prod. Subproduto",-1)),e[12]||(e[12]=t("th",{class:"text-center align-middle"},"Cod.SIAC",-1)),e[13]||(e[13]=t("th",{class:"text-center align-middle"},"Descrição do Serviço",-1)),e[14]||(e[14]=t("th",{class:"text-center align-middle"},"Quantidade",-1)),e[15]||(e[15]=t("th",{class:"text-center align-middle"},"Unidade",-1)),e[16]||(e[16]=t("th",{class:"text-center align-middle"},"Qtd. Medida",-1)),e[17]||(e[17]=t("th",{class:"text-center align-middle"},"SEI Versão Aprovada",-1)),e[18]||(e[18]=t("th",{class:"text-center align-middle"},"Parecer Técnico/Portaria/Ofício Aprovação - SEI",-1)),a.user?(n(),i("th",Q,"Ações")):r("",!0)])]),t("tbody",null,[(n(!0),i(A,null,O(a.subprodutos,s=>(n(),i("tr",{key:s.id},[t("td",$,l(s.rodovia),1),t("td",G,l(s.id_subproduto||"-"),1),t("td",J,l(s.cod_siac||"-"),1),t("td",H,l(s.subproduto||"-"),1),t("td",K,l(s.quantidade||"-"),1),t("td",W,l(s.unidade||"-"),1),t("td",Y,l(s.quantidade_medida||"-"),1),t("td",Z,l(s.sei_versao_aprovada||"-"),1),t("td",tt,l(s.oficio_numero||"-"),1),a.user?(n(),i("td",et,[t("div",st,[t("button",{class:"btn btn-danger btn-sm mr-1",onClick:it=>v(s.id)},"Excluir",8,ot),t("a",{href:`/subprodutos/${s.id}/edit`,class:"btn btn-warning btn-sm"},"Editar",8,lt)])])):r("",!0)]))),128)),a.subprodutos.length?r("",!0):(n(),i("tr",dt,[t("td",{colspan:a.user?10:9,class:"text-center align-middle"},"Nenhum subproduto encontrado.",8,at)]))])])])])])])]))}};export{ct as default};
